CREATE FUNCTION create_asymmetric_priv_key RETURNS STRING SONAME "ENCRYPTION_UDF_LIB";
CREATE FUNCTION create_asymmetric_pub_key RETURNS STRING SONAME "ENCRYPTION_UDF_LIB";
CREATE FUNCTION create_dh_parameters RETURNS STRING SONAME "ENCRYPTION_UDF_LIB";
CREATE FUNCTION asymmetric_derive RETURNS STRING SONAME "ENCRYPTION_UDF_LIB";
** [DH][4096] generating parameters
SET @dh_params = create_dh_parameters(4096);
** [DH][4096] generating private/public keys from parameters
SET @dh_priv1 = create_asymmetric_priv_key('DH', @dh_params);
SET @dh_pub1 =  create_asymmetric_pub_key('DH', @dh_priv1);
SET @dh_priv2 = create_asymmetric_priv_key('DH', @dh_params);
SET @dh_pub2 =  create_asymmetric_pub_key('DH', @dh_priv2);
** [DH][4096] verifying shared key generation
SET @shared1 = asymmetric_derive(@dh_pub1, @dh_priv2);
SET @shared2 = asymmetric_derive(@dh_pub2, @dh_priv1);
DROP FUNCTION asymmetric_derive;
DROP FUNCTION create_dh_parameters;
DROP FUNCTION create_asymmetric_pub_key;
DROP FUNCTION create_asymmetric_priv_key;
