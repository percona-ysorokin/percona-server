include/rpl/init_source_replica.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the connection metadata repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
[connection master]
[connection master]
SET GLOBAL DEBUG='+d,masking_functions_signal_on_cache_reload';
INSTALL COMPONENT 'file://component_masking_functions';
[connection slave]
SET GLOBAL DEBUG='+d,masking_functions_signal_on_cache_reload';
INSTALL COMPONENT 'file://component_masking_functions';
[connection master]
CREATE TABLE mysql.masking_dictionaries(
Dictionary VARCHAR(256) NOT NULL,
Term VARCHAR(256) NOT NULL,
UNIQUE INDEX dictionary_term_idx (Dictionary, Term)
) ENGINE = InnoDB DEFAULT CHARSET=utf8mb4;
GRANT MASKING_DICTIONARIES_ADMIN ON *.* TO root@localhost;
SELECT masking_dictionary_term_add('single_dict_1', 'entry_1');
masking_dictionary_term_add('single_dict_1', 'entry_1')
1
SELECT masking_dictionary_term_add('single_dict_2', 'entry_2');
masking_dictionary_term_add('single_dict_2', 'entry_2')
1
SELECT gen_dictionary('single_dict_1');
gen_dictionary('single_dict_1')
entry_1
SELECT gen_dictionary('single_dict_2');
gen_dictionary('single_dict_2')
entry_2
include/rpl/sync.inc
[connection slave]
GRANT MASKING_DICTIONARIES_ADMIN ON *.* TO root@localhost;
SELECT * FROM mysql.masking_dictionaries;
Dictionary	Term
single_dict_1	entry_1
single_dict_2	entry_2
SELECT masking_dictionaries_flush();
masking_dictionaries_flush()
1
SELECT gen_dictionary('single_dict_1');
gen_dictionary('single_dict_1')
entry_1
SELECT gen_dictionary('single_dict_2');
gen_dictionary('single_dict_2')
entry_2
[connection master]
INSERT INTO mysql.masking_dictionaries VALUES ('single_dict_3', 'entry_3');
SELECT gen_dictionary('single_dict_3');
gen_dictionary('single_dict_3')
NULL
SET DEBUG_SYNC='now SIGNAL masking_functions_before_cache_reload WAIT_FOR masking_functions_after_cache_reload';
SELECT gen_dictionary('single_dict_3');
gen_dictionary('single_dict_3')
entry_3
include/rpl/sync.inc
[connection slave]
SELECT * FROM mysql.masking_dictionaries;
Dictionary	Term
single_dict_1	entry_1
single_dict_2	entry_2
single_dict_3	entry_3
SELECT gen_dictionary('single_dict_3');
gen_dictionary('single_dict_3')
NULL
SET DEBUG_SYNC='now SIGNAL masking_functions_before_cache_reload WAIT_FOR masking_functions_after_cache_reload';
SELECT gen_dictionary('single_dict_3');
gen_dictionary('single_dict_3')
entry_3
[connection slave]
REVOKE MASKING_DICTIONARIES_ADMIN ON *.* FROM root@localhost;
SET GLOBAL DEBUG='-d,masking_functions_signal_on_cache_reload';
UNINSTALL COMPONENT 'file://component_masking_functions';
[connection master]
REVOKE MASKING_DICTIONARIES_ADMIN ON *.* FROM root@localhost;
SET GLOBAL DEBUG='-d,masking_functions_signal_on_cache_reload';
UNINSTALL COMPONENT 'file://component_masking_functions';
DROP TABLE mysql.masking_dictionaries;
include/rpl/sync.inc
include/rpl/deinit.inc
